function TorrentRendererHelper(){}TorrentRendererHelper.getProgressInfo=function(c,d){var f,b,e=d.getStatus(),a=d.seedRatioLimit(c);if(d.needsMetaData()){f=d.getMetadataPercentComplete()*100}else{if(!d.isDone()){f=Math.round(d.getPercentDone()*100)}else{if(a>0&&d.isSeeding()){f=Math.round(d.getUploadRatio()*100/a)}else{f=100}}}if(e===Torrent._StatusStopped){b="paused"}else{if(e===Torrent._StatusDownloadWait){b="leeching queued"}else{if(d.needsMetaData()){b="magnet"}else{if(e===Torrent._StatusDownload){b="leeching"}else{if(e===Torrent._StatusSeedWait){b="seeding queued"}else{if(e===Torrent._StatusSeed){b="seeding"}else{b=""}}}}}}return{percent:f,complete:["torrent_progress_bar","complete",b].join(" "),incomplete:["torrent_progress_bar","incomplete",b].join(" ")}};TorrentRendererHelper.createProgressbar=function(d){var c,b,a;c=document.createElement("div");c.className="torrent_progress_bar complete";b=document.createElement("div");b.className="torrent_progress_bar incomplete";a=document.createElement("div");a.className="torrent_progress_bar_container "+d;a.appendChild(c);a.appendChild(b);return{element:a,complete:c,incomplete:b}};TorrentRendererHelper.renderProgressbar=function(b,c,a){var i,f,d,h,g=TorrentRendererHelper.getProgressInfo(b,c);i=a.complete;f=i.style;d=""+g.percent+"%";h=g.percent>0?"block":"none";if(f.width!==d||f.display!==h){$(i).css({width:""+g.percent+"%",display:h})}if(i.className!==g.complete){i.className=g.complete}i=a.incomplete;h=(g.percent<100)?"block":"none";if(i.style.display!==h){i.style.display=h}if(i.className!==g.incomplete){i.className=g.incomplete}};TorrentRendererHelper.formatUL=function(a){return"↑ "+Transmission.fmt.speedBps(a.getUploadSpeed())};TorrentRendererHelper.formatDL=function(a){return"↓ "+Transmission.fmt.speedBps(a.getDownloadSpeed())};function TorrentRendererFull(){}TorrentRendererFull.prototype={createRow:function(){var c,d,a,b,f,g,e;c=document.createElement("li");c.className="torrent";d=document.createElement("div");d.className="torrent_name";a=document.createElement("div");a.className="torrent_peer_details";b=TorrentRendererHelper.createProgressbar("full");f=document.createElement("div");f.className="torrent_progress_details";g=document.createElement("div");e=document.createElement("a");e.appendChild(g);c.appendChild(d);c.appendChild(a);c.appendChild(e);c.appendChild(b.element);c.appendChild(f);c._name_container=d;c._peer_details_container=a;c._progress_details_container=f;c._progressbar=b;c._pause_resume_button_image=g;c._toggle_running_button=e;return c},getPeerDetails:function(c){var d,a,e,b=Transmission.fmt;if((d=c.getErrorMessage())){return d}if(c.isDownloading()){a=c.getPeersConnected();e=c.getWebseedsSendingToUs();if(e&&a){return["从",c.getPeersSendingToUs(),"/",b.countString("个节点下载","个节点下载",a),"and",b.countString("web seed","web seeds",e),"-",TorrentRendererHelper.formatDL(c),TorrentRendererHelper.formatUL(c)].join(" ")}else{if(e){return["从",b.countString("web seed","web seeds",e),"-",TorrentRendererHelper.formatDL(c),TorrentRendererHelper.formatUL(c)].join(" ")}else{return["从",c.getPeersSendingToUs(),"/",b.countString("个节点下载","个节点下载",a),"-",TorrentRendererHelper.formatDL(c),TorrentRendererHelper.formatUL(c)].join(" ")}}}if(c.isSeeding()){return["向",c.getPeersGettingFromUs(),"/",b.countString("个节点做种","个节点做种",c.getPeersConnected()),"-",TorrentRendererHelper.formatUL(c)].join(" ")}if(c.isChecking()){return["正在校验本地数据 (",Transmission.fmt.percentString(100*c.getRecheckProgress()),"% 已测试)"].join("")}return c.getStateString()},getProgressDetails:function(d,e){if(e.needsMetaData()){var h=100*e.getMetadataPercentComplete();return["Magnetized transfer - retrieving metadata (",Transmission.fmt.percentString(h),"%)"].join("")}var i,b=e.getSizeWhenDone(),a=e.getTotalSize(),g=e.isDone()||e.isSeeding();if(g){if(a===b){i=["已下载 ",Transmission.fmt.size(a)]}else{i=["已下载 ",Transmission.fmt.size(b)," 总共 ",Transmission.fmt.size(e.getTotalSize())," (",e.getPercentDoneStr(),"%)"]}i.push(", 已上传 ",Transmission.fmt.size(e.getUploadedEver())," (分享率 ",Transmission.fmt.ratioString(e.getUploadRatio()),")")}else{i=["已下载 ",Transmission.fmt.size(b-e.getLeftUntilDone())," 总共 ",Transmission.fmt.size(b)," (",e.getPercentDoneStr(),"%)"]}if(!e.isStopped()&&(!g||e.seedRatioLimit(d)>0)){i.push(" - ");var f=e.getETA();if(f<0||f>=(999*60*60)){i.push("剩余时间未知")}else{i.push(", 剩余时间 ",Transmission.fmt.timeInterval(e.getETA()))}}return i.join("")},render:function(c,d,b){setTextContent(b._name_container,d.getName());TorrentRendererHelper.renderProgressbar(c,d,b._progressbar);var f=d.getError()!==Torrent._ErrNone;var g=b._peer_details_container;$(g).toggleClass("error",f);setTextContent(g,this.getPeerDetails(d));g=b._progress_details_container;setTextContent(g,this.getProgressDetails(c,d));var a=d.isStopped();g=b._pause_resume_button_image;g.alt=a?"Resume":"Pause";g.className=a?"torrent_resume":"torrent_pause"}};function TorrentRendererCompact(){}TorrentRendererCompact.prototype={createRow:function(){var b,d,c,a;b=TorrentRendererHelper.createProgressbar("compact");d=document.createElement("div");d.className="torrent_peer_details compact";c=document.createElement("div");c.className="torrent_name compact";a=document.createElement("li");a.appendChild(b.element);a.appendChild(d);a.appendChild(c);a.className="torrent compact";a._progressbar=b;a._details_container=d;a._name_container=c;return a},getPeerDetails:function(b){var f;if((f=b.getErrorMessage())){return f}if(b.isDownloading()){var e=b.getDownloadSpeed()>0,a=b.getUploadSpeed()>0;if(!a&&!e){return"Idle"}var d="";if(e){d+=TorrentRendererHelper.formatDL(b)}if(e&&a){d+=" "}if(a){d+=TorrentRendererHelper.formatUL(b)}return d}if(b.isSeeding()){return["Ratio: ",Transmission.fmt.ratioString(b.getUploadRatio()),", ",TorrentRendererHelper.formatUL(b)].join("")}return b.getStateString()},render:function(c,d,b){var a=d.isStopped();var g=b._name_container;$(g).toggleClass("paused",a);setTextContent(g,d.getName());var f=d.getError()!==Torrent._ErrNone;g=b._details_container;$(g).toggleClass("error",f);setTextContent(g,this.getPeerDetails(d));TorrentRendererHelper.renderProgressbar(c,d,b._progressbar)}};function TorrentRow(b,a,c){this.initialize(b,a,c)}TorrentRow.prototype={initialize:function(b,a,c){var d=this;this._view=b;this._torrent=c;this._element=b.createRow();this.render(a);$(this._torrent).bind("dataChanged.torrentRowListener",function(){d.render(a)})},getElement:function(){return this._element},render:function(a){var b=this.getTorrent();if(b){this._view.render(a,b,this.getElement())}},isSelected:function(){return this.getElement().className.indexOf("selected")!==-1},getTorrent:function(){return this._torrent},getTorrentId:function(){return this.getTorrent().getId()}};