function PrefsDialog(c){var j={dialog:null,remote:null,elements:{},keys:["alt-speed-down","alt-speed-time-begin","alt-speed-time-day","alt-speed-time-enabled","alt-speed-time-end","alt-speed-up","blocklist-enabled","blocklist-size","blocklist-url","dht-enabled","download-dir","encryption","idle-seeding-limit","idle-seeding-limit-enabled","lpd-enabled","peer-limit-global","peer-limit-per-torrent","peer-port","peer-port-random-on-start","pex-enabled","port-forwarding-enabled","rename-partial-files","seedRatioLimit","seedRatioLimited","speed-limit-down","speed-limit-down-enabled","speed-limit-up","speed-limit-up-enabled","start-added-torrents","utp-enabled"],groups:{"alt-speed-time-enabled":["alt-speed-time-begin","alt-speed-time-day","alt-speed-time-end"],"blocklist-enabled":["blocklist-url","blocklist-update-button"],"idle-seeding-limit-enabled":["idle-seeding-limit"],seedRatioLimited:["seedRatioLimit"],"speed-limit-down-enabled":["speed-limit-down"],"speed-limit-up-enabled":["speed-limit-up"]}},o=function(u){var q,p,s,t,r;for(q=0;q<24*4;++q){p=parseInt(q/4,10);s=((q%4)*15);t=q*15;r=p+":"+(s||"00");u.options[q]=new Option(r,t)}},a=function(p){var r=p["arguments"]["port-is-open"],s="端口已 <b>"+(r?"开启":"关闭")+"</b>",q=j.elements.root.find("#port-label");setInnerHTML(q[0],s)},l=function(q,r){var t,s,u,p;if(q in j.groups){p=j.elements.root,u=j.groups[q];for(t=0;s=u[t];++t){p.find("#"+s).attr("disabled",!r)}}},b=function(){j.remote.updateBlocklist();m(false)},m=function(p){var q=j.elements.blocklist_button;q.attr("disabled",!p);q.val(p?"更新黑名单":"更新中...")},g=function(p){var q;switch(p[0].type){case"checkbox":case"radio":return p.prop("checked");case"text":case"url":case"email":case"number":case"search":case"select-one":q=p.val();if(parseInt(q,10).toString()===q){return parseInt(q,10)}if(parseFloat(q).toString()===q){return parseFloat(q)}return q;default:return null}},n=function(p){var q={};q[p.target.id]=g($(p.target));j.remote.savePrefs(q)},d=function(p){j.oldValue=g($(p.target))},f=function(p){var q=g($(p.target));if(q!==j.oldValue){var r={};r[p.target.id]=q;j.remote.savePrefs(r);delete j.oldValue}},e=function(){return{width:$(window).width(),height:$(window).height(),position:["left","top"]}},i=function(r){var q,p,s,t;j.remote=r;s=$("#prefs-dialog");j.elements.root=s;o(s.find("#alt-speed-time-begin")[0]);o(s.find("#alt-speed-time-end")[0]);t=isMobileDevice?e():{width:350,height:400};t.autoOpen=false;t.show=t.hide="fade";t.close=k;s.tabbedDialog(t);s=s.find("#blocklist-update-button");j.elements.blocklist_button=s;s.click(b);for(q=0;p=j.keys[q];++q){s=j.elements.root.find("#"+p);switch(s[0].type){case"checkbox":case"radio":case"select-one":s.change(n);break;case"text":case"url":case"email":case"number":case"search":s.focus(d);s.blur(f);default:break}}},h=function(){var r,q,u,t={},s=j.keys,p=j.elements.root;for(r=0;q=s[r];++r){u=g(p.find("#"+q));if(u!==null){t[q]=u}}return t},k=function(){transmission.hideMobileAddressbar();$(j.dialog).trigger("closed",h())};this.set=function(w){var u,r,q,v,s,t=j.keys,p=j.elements.root;m(true);for(r=0;q=t[r];++r){v=w[q];u=p.find("#"+q);if(q==="blocklist-size"){u.text(""+v.toStringWithCommas())}else{switch(u[0].type){case"checkbox":case"radio":u.prop("checked",v);l(q,v);break;case"text":case"url":case"email":case"number":case"search":if(u[0]!==document.activeElement){u.val(v)}break;case"select-one":u.val(v);break;default:break}}}};this.show=function(){transmission.hideMobileAddressbar();m(true);j.remote.checkPort(a,this);j.elements.root.dialog("open")};this.close=function(){transmission.hideMobileAddressbar();j.elements.root.dialog("close")},this.shouldAddedTorrentsStart=function(){return j.elements.root.find("#start-added-torrents")[0].checked};j.dialog=this;i(c)};